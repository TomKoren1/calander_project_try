<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Database Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        .container {
            max-width: 1200px;
        }
        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        th {
            background-color: #f3f4f6;
            color: #1f2937;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        tr:hover {
            background-color: #f0fdf4; /* Light green hover for visual feedback */
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #10b981;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="container mx-auto bg-white shadow-xl rounded-2xl p-6 md:p-10">

        <header class="mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-2">Product Catalog Dashboard</h1>
            <p class="text-gray-500">
                Displaying data retrieved from a simulated SQL database API endpoint.
            </p>
        </header>

        <div class="mb-6 flex flex-col sm:flex-row gap-4 items-center">
            <input
                type="text"
                id="search-input"
                placeholder="Search by product name or category..."
                class="w-full sm:w-80 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition duration-150"
                oninput="handleSearch()"
            >
            <div id="record-count" class="text-sm text-gray-600 sm:ml-auto"></div>
        </div>

        <div class="overflow-x-auto rounded-xl border border-gray-200 shadow-lg">
            <table class="min-w-full divide-y divide-gray-200">
                <thead>
                    <tr>
                        <th class="px-6 py-3">ID</th>
                        <th class="px-6 py-3">Product Name</th>
                        <th class="px-6 py-3">Category</th>
                        <th class="px-6 py-3">Price</th>
                        <th class="px-6 py-3">Stock</th>
                    </tr>
                </thead>
                <tbody id="table-body" class="bg-white divide-y divide-gray-200">
                    <tr id="loading-row">
                        <td colspan="5" class="text-center py-10">
                            <div class="flex justify-center items-center space-x-3 text-teal-600">
                                <div class="loading-spinner"></div>
                                <span class="font-medium">Loading Database Records...</span>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="message-box" class="mt-4 p-4 text-sm rounded-lg hidden" role="alert"></div>
    </div>

    <script>
        // Global variable to hold the full dataset after loading
        let fullDataset = [];

        const tableBody = document.getElementById('table-body');
        const searchInput = document.getElementById('search-input');
        const recordCountElement = document.getElementById('record-count');
        const messageBox = document.getElementById('message-box');

        // --- API CONFIGURATION ---
        // This is the endpoint our Python Flask server is running on
        const API_URL = 'http://127.0.0.1:5000/api/products';


        /**
         * Clears the message box.
         */
        function clearMessage() {
            messageBox.classList.add('hidden');
            messageBox.textContent = '';
            messageBox.className = 'mt-4 p-4 text-sm rounded-lg hidden'; // Reset classes
        }

        /**
         * Displays a message (error or info) in the designated box.
         * @param {string} message - The text message to display.
         * @param {string} type - 'error' or 'info'.
         */
        function displayMessage(message, type = 'info') {
            clearMessage();
            messageBox.textContent = message;
            messageBox.classList.remove('hidden');

            if (type === 'error') {
                messageBox.classList.add('bg-red-100', 'text-red-700', 'border', 'border-red-400');
            } else {
                messageBox.classList.add('bg-blue-100', 'text-blue-700', 'border', 'border-blue-400');
            }
        }

        /**
         * Renders the given array of data objects into the table body.
         * @param {Array<Object>} data - The dataset to render.
         */
        function renderTable(data) {
            // Clear existing rows
            tableBody.innerHTML = '';
            clearMessage();

            if (data.length === 0) {
                // Display 'No results' message
                const row = tableBody.insertRow();
                const cell = row.insertCell();
                cell.colSpan = 5;
                cell.className = 'text-center py-8 text-gray-500';
                cell.textContent = 'No records found matching your search criteria.';
                recordCountElement.textContent = '0 Records Shown';
                return;
            }

            data.forEach(item => {
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td class="text-gray-600 font-mono">${item.id}</td>
                    <td class="font-medium text-gray-900">${item.name}</td>
                    <td class="text-teal-600">${item.catagory}</td>
                    <td class="text-gray-800">$${item.price.toFixed(2)}</td>
                    <td class="text-gray-700">${item.stock}</td>
                `;
            });

            recordCountElement.textContent = `${data.length} Records Shown`;
        }

        /**
         * Filters the full dataset based on the search input value.
         */
        function handleSearch() {
            const query = searchInput.value.toLowerCase().trim();

            if (!query) {
                renderTable(fullDataset);
                return;
            }

            const filteredData = fullDataset.filter(item =>
                item.name.toLowerCase().includes(query) ||
                item.category.toLowerCase().includes(query) ||
                item.id.toString().includes(query)
            );

            renderTable(filteredData);
        }

        /**
         * Initialization function: fetches data and sets up the table.
         * NOW using a REAL fetch call to the Python/Flask API.
         */
        async function init() {
            try {
                // 1. Fetch data from the Python/Flask API endpoint
                const response = await fetch(API_URL);

                if (!response.ok) {
                    const errorJson = await response.json();
                    throw new Error(errorJson.error || `HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                // Store the fetched data globally and render it
                fullDataset = data;
                renderTable(fullDataset);

            } catch (error) {
                console.error("Initialization Error:", error);
                // Display a user-friendly error message if the API is unreachable (server not running)
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                     displayMessage(`Error: Could not connect to the Python API server at ${API_URL}. Please ensure the 'app.py' server is running. (Details: ${error.message})`, 'error');
                } else {
                    // Display API-returned errors
                    displayMessage(`Error retrieving data: ${error.message}`, 'error');
                }
                // Clear loading row and show error in table as well
                tableBody.innerHTML = `<tr><td colspan="5" class="text-center py-8 text-red-600">${error.message}</td></tr>`;
            }
        }

        // Run the initialization function when the page loads
        window.onload = init;
    </script>

</body>
</html>
```eof

***

### ðŸš€ Next Steps

1.  **Save the file:** Create a new text file and save the content above as **`database_viewer.html`**.
2.  **Run the Server:** Make sure you have **`app.py`** running in your terminal (`python app.py`).
3.  **View the Website:** Double-click the saved `database_viewer.html` file to open the beautiful, interactive table in your browser.